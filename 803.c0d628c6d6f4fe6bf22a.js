"use strict";(self.webpackChunkproduction_project=self.webpackChunkproduction_project||[]).push([[803],{9803:function(e,a,r){r.r(a),r.d(a,{default:function(){return de}});var i=r(7294),t=r(6974),n=r(1752),l=r(1072),s=r(3942),o=r(729),d=r(7090),c=r(3562),u=r(2647),C=r(1174),f=r(3549),m=r(3875);let h=function(e){return e.RUB="RUB",e.EUR="EUR",e.USD="USD",e}({});var x=r(7744),g=r(5893);const R=[{value:h.RUB,content:h.RUB},{value:h.EUR,content:h.EUR},{value:h.USD,content:h.USD}],p=e=>{const{t:a}=(0,l.$G)(),{className:r,value:t=h.EUR,onChange:n,readonly:s}=e,o=(0,i.useCallback)((e=>{n?.(e)}),[n]);return(0,g.jsx)(x.w,{readonly:s,items:R,className:(0,d.Z)("",{},[r]),value:t,onChange:o})};let v=function(e){return e.Russia="Russia",e.Belarus="Belarus",e.Ukraine="Ukraine",e.Kazakhstan="Kazahstan",e.Armenia="Armenia",e}({});const E=[{value:v.Armenia,content:v.Armenia},{value:v.Russia,content:v.Russia},{value:v.Belarus,content:v.Belarus},{value:v.Kazakhstan,content:v.Kazakhstan},{value:v.Ukraine,content:v.Ukraine}],j=(0,i.memo)((e=>{let{className:a,value:r=v.Belarus,onChange:t,readonly:n}=e;const{t:s}=(0,l.$G)(),o=(0,i.useCallback)((e=>{t?.(e)}),[t]);return(0,g.jsx)(x.w,{readonly:n,items:E,className:(0,d.Z)("",{},[a]),value:r,onChange:o,direction:"top right"})}));var P=r(8211),N=r(3379),y=r.n(N),_=r(7795),T=r.n(_),U=r(569),k=r.n(U),A=r(3565),I=r.n(A),O=r(9216),Z=r.n(O),b=r(4589),D=r.n(b),w=r(5108),z={};z.styleTagTransform=D(),z.setAttributes=I(),z.insert=k().bind(null,"head"),z.domAPI=T(),z.insertStyleElement=Z(),y()(w.Z,z);var S=w.Z&&w.Z.locals?w.Z.locals:void 0,L=r(1889),V=r(7277);const H=e=>{const{className:a,data:r,isLoading:i,error:t,readonly:n,onChangeFirstName:s,onChangeLastName:c,onChangeAge:u,onChangeCity:h,onChangeAvatar:x,onChangeUsername:R,onChangeCountry:v,onChangeCurrency:E}=e,{t:N}=(0,l.$G)("profile");return i?(0,g.jsx)(P.U,{justify:"center",max:!0,className:(0,d.Z)(S.ProfileCard,{},[a,S.loading]),children:(0,g.jsx)(f.a,{})}):t?(0,g.jsx)(P.U,{justify:"center",max:!0,className:(0,d.Z)(S.ProfileCard,{},[a,S.error]),children:(0,g.jsx)(o.xv,{theme:o.d9.ERROR,title:N("Произошла ошибка при загрузке профиля"),text:N("Попробуйте обновить страницу"),align:o.PH.CENTER})}):(0,g.jsxs)(P.g,{gap:"24",max:!0,className:(0,d.Z)(S.ProfileCard,{},[a]),children:[(0,g.jsxs)(P.U,{gap:"24",align:"start",children:[r?.avatar&&(0,g.jsx)(V.k,{justify:"center",className:S.avatarWrapper,children:(0,g.jsx)(m.q,{size:"100%",src:r?.avatar,className:S.avatar})}),(0,g.jsxs)(P.g,{gap:"24",max:!0,children:[(0,g.jsx)(o.xv,{text:N("Личные данные"),size:o.yH.L}),(0,g.jsxs)(P.U,{gap:"16",max:!0,children:[(0,g.jsxs)(V.k,{direction:"column",align:"start",children:[(0,g.jsx)(o.xv,{text:N("Имя"),size:o.yH.M,theme:o.d9.INVERTED}),(0,g.jsx)(L.Z,{children:(0,g.jsx)(C.I,{value:r?.firstname,className:S.input,onChange:s,readonly:n})})]}),(0,g.jsxs)(V.k,{direction:"column",align:"start",children:[(0,g.jsx)(o.xv,{text:N("Фамилия"),size:o.yH.M,theme:o.d9.INVERTED}),(0,g.jsx)(L.Z,{children:(0,g.jsx)(C.I,{value:r?.lastname,className:S.input,onChange:c,readonly:n})})]})]}),(0,g.jsxs)(P.U,{gap:"16",max:!0,children:[(0,g.jsxs)(V.k,{direction:"column",align:"start",children:[(0,g.jsx)(o.xv,{text:N("Имя пользователя"),size:o.yH.M,theme:o.d9.INVERTED}),(0,g.jsx)(L.Z,{children:(0,g.jsx)(C.I,{value:r?.username,className:S.input,onChange:R,readonly:n})})]}),(0,g.jsxs)(V.k,{direction:"column",align:"start",children:[(0,g.jsx)(o.xv,{text:N("Возраст"),size:o.yH.M,theme:o.d9.INVERTED}),(0,g.jsx)(L.Z,{children:(0,g.jsx)(C.I,{value:r?.age,className:S.inputAge,onChange:u,readonly:n})})]})]})]})]}),(0,g.jsxs)(P.g,{gap:"24",children:[(0,g.jsx)(o.xv,{text:N("Настройки профиля"),size:o.yH.L}),(0,g.jsxs)(P.U,{gap:"24",children:[(0,g.jsxs)(V.k,{direction:"column",align:"start",children:[(0,g.jsx)(o.xv,{text:N("Аватар"),size:o.yH.M,theme:o.d9.INVERTED}),(0,g.jsx)(L.Z,{children:(0,g.jsx)(C.I,{value:r?.avatar,className:S.input,onChange:x,readonly:n})})]}),(0,g.jsxs)(V.k,{direction:"column",align:"start",children:[(0,g.jsx)(o.xv,{text:N("Валюта"),size:o.yH.M,theme:o.d9.INVERTED}),(0,g.jsx)(L.Z,{children:(0,g.jsx)(p,{value:r?.currency,className:S.input,onChange:E,readonly:n})})]}),(0,g.jsxs)(V.k,{direction:"column",align:"start",children:[(0,g.jsx)(o.xv,{text:N("Страна"),size:o.yH.M,theme:o.d9.INVERTED}),(0,g.jsx)(L.Z,{children:(0,g.jsx)(j,{value:r?.country,className:S.input,onChange:v,readonly:n})})]}),(0,g.jsxs)(V.k,{direction:"column",align:"start",children:[(0,g.jsx)(o.xv,{text:N("Город"),size:o.yH.M,theme:o.d9.INVERTED}),(0,g.jsx)(L.Z,{children:(0,g.jsx)(C.I,{value:r?.city,className:S.input,onChange:h,readonly:n})})]})]})]})]})};var W=r(4495);let B=function(e){return e.INCORRECT_USER_DATA="INCORRECT_USER_DATA",e.INCORRECT_AGE="INCORRECT_AGE",e.INCORRECT_COUNTRY="INCORRECT_COUNTRY",e.NO_DATA="NO_DATA",e.SERVER_ERROR="SERVER_ERROR",e}({});var G=r(6088);const M=e=>e.profile?.readonly;var Y=r(4268);const K=(0,Y.hg)("profile/fetchProfileData",(async(e,a)=>{const{rejectWithValue:r,extra:i}=a;try{if(!e)throw new Error("error, no profile id");const a=await i.api.get(`/profile/${e}`);if(!a.data)throw new Error;return a.data}catch(e){return r("error")}})),$=e=>e.profile?.form,F=(0,Y.hg)("profile/updateProfileData",(async(e,a)=>{const{rejectWithValue:r,extra:i,getState:t}=a,n=$(t()),l=(e=>{if(!e)return[B.NO_DATA];const{firstname:a,lastname:r,age:i,country:t}=e,n=[];return a&&r||n.push(B.INCORRECT_USER_DATA),i&&Number.isInteger(i)||n.push(B.INCORRECT_AGE),t||n.push(B.INCORRECT_COUNTRY),n})(n);if(l?.length)return r(l);try{const e=await i.api.put(`/profile/${n?.id}`,n);if(!e.data)throw new Error;return e.data}catch(e){return r([B.SERVER_ERROR])}})),Q=(0,Y.oM)({name:"profile",initialState:{readonly:!0,isLoading:!1,error:void 0,data:void 0},reducers:{setReadonly:(e,a)=>{let{payload:r}=a;e.readonly=r},cancelEdit:e=>{e.readonly=!0,e.validateErrors=void 0,e.form=e.data},updateProfile:(e,a)=>{let{payload:r}=a;e.form={...e.form,...r}}},extraReducers:e=>{e.addCase(K.fulfilled,((e,a)=>{let{payload:r}=a;e.isLoading=!1,e.data=r,e.form=r})).addCase(K.pending,(e=>{e.validateErrors=void 0,e.isLoading=!0})).addCase(K.rejected,((e,a)=>{let{payload:r}=a;e.isLoading=!1,e.error=r})).addCase(F.fulfilled,((e,a)=>{let{payload:r}=a;e.isLoading=!1,e.data=r,e.form=r,e.readonly=!0,e.validateErrors=void 0})).addCase(F.pending,(e=>{e.isLoading=!0,e.validateErrors=void 0})).addCase(F.rejected,((e,a)=>{let{payload:r}=a;e.isLoading=!1,e.validateErrors=r}))}}),{actions:J}=Q,{reducer:q}=Q;var X=r(2222),ee=r(1289);const ae=(0,X.P1)(ee.m5,(e=>e.profile?.data),((e,a)=>e?.id===a?.id));var re=r(7363);const ie=(0,i.memo)((e=>{let{className:a}=e;const{t:r}=(0,l.$G)("profile"),t=(0,u.T)(),n=(0,s.v9)(M),c=(0,s.v9)(ae),C=(0,i.useCallback)((()=>{t(J.setReadonly(!1))}),[t]),f=(0,i.useCallback)((()=>{t(J.cancelEdit())}),[t]),m=(0,i.useCallback)((()=>{t(F())}),[t]);return(0,g.jsxs)(P.U,{max:!0,justify:"between",className:(0,d.Z)(re.Z.EditableProfileCardHeader,{},[a]),children:[(0,g.jsx)(o.xv,{title:r("Профиль"),size:o.yH.L,className:re.Z.title}),c&&(0,g.jsx)("div",{children:n?(0,g.jsx)(G.zx,{theme:G.UH.OUTLINE,onClick:C,children:r("Редактировать")}):(0,g.jsxs)(P.U,{gap:"8",children:[(0,g.jsx)(G.zx,{theme:G.UH.OUTLINE_RED,onClick:f,children:r("Отменить")}),(0,g.jsx)(G.zx,{theme:G.UH.BACKGROUND_INVERTED,onClick:m,children:r("Сохранить")})]})})]})})),te=e=>e.profile?.validateErrors,ne=e=>e.profile?.error,le=e=>e.profile?.isLoading,se={profile:q},oe=(0,i.memo)((e=>{const{className:a,id:r}=e,t=(0,u.T)(),{t:n}=(0,l.$G)("profile"),C={[B.SERVER_ERROR]:n("Ошибка сервера при сохранении"),[B.NO_DATA]:n("Данные не указаны"),[B.INCORRECT_COUNTRY]:n("Некорректный регион"),[B.INCORRECT_USER_DATA]:n("Имя и фамилия обязательны"),[B.INCORRECT_AGE]:n("Некорректный возраст")},f=(0,s.v9)($),m=(0,s.v9)(le),h=(0,s.v9)(ne),x=(0,s.v9)(M),R=(0,s.v9)(te);(0,c.Q)((()=>{t(K(r))}));const p=(0,i.useCallback)((e=>{t(J.updateProfile({firstname:e||""}))}),[t]),v=(0,i.useCallback)((e=>{t(J.updateProfile({lastname:e||""}))}),[t]),E=(0,i.useCallback)((e=>{t(J.updateProfile({age:Number(e||0)}))}),[t]),j=(0,i.useCallback)((e=>{t(J.updateProfile({city:e||""}))}),[t]),N=(0,i.useCallback)((e=>{t(J.updateProfile({username:e||""}))}),[t]),y=(0,i.useCallback)((e=>{t(J.updateProfile({avatar:e||""}))}),[t]),_=(0,i.useCallback)((e=>{t(J.updateProfile({country:e||""}))}),[t]),T=(0,i.useCallback)((e=>{t(J.updateProfile({currency:e||""}))}),[t]);return(0,g.jsx)(W.W,{reducers:se,removeAfterUnmount:!0,children:(0,g.jsxs)(P.g,{gap:"32",className:(0,d.Z)("",{},[a]),children:[(0,g.jsx)(ie,{}),R?.length&&R.map((e=>(0,g.jsx)(o.xv,{theme:o.d9.ERROR,text:C[e]},e))),(0,g.jsx)(H,{data:f,isLoading:m,error:h,readonly:x,onChangeFirstName:p,onChangeLastName:v,onChangeAge:E,onChangeCity:j,onChangeUsername:N,onChangeAvatar:y,onChangeCountry:_,onChangeCurrency:T})]})})}));var de=()=>{const{id:e}=(0,t.UO)();return(0,g.jsx)(n.T,{children:(0,g.jsx)(oe,{id:e})})}},5108:function(e,a,r){var i=r(8081),t=r.n(i),n=r(3645),l=r.n(n)()(t());l.push([e.id,".src-entities-Profile-ui-ProfileCard-ProfileCard-module__ProfileCard--wW9jg .src-entities-Profile-ui-ProfileCard-ProfileCard-module__avatarWrapper--bEFNS{align-self:center;width:300px;height:200px}.src-entities-Profile-ui-ProfileCard-ProfileCard-module__ProfileCard--wW9jg .src-entities-Profile-ui-ProfileCard-ProfileCard-module__avatarWrapper--bEFNS .src-entities-Profile-ui-ProfileCard-ProfileCard-module__avatar--ktDYi{object-fit:cover}.src-entities-Profile-ui-ProfileCard-ProfileCard-module__ProfileCard--wW9jg .src-entities-Profile-ui-ProfileCard-ProfileCard-module__inputAge--VfQJ_{width:65px}.src-entities-Profile-ui-ProfileCard-ProfileCard-module__loading--t07Zx,.src-entities-Profile-ui-ProfileCard-ProfileCard-module__error--i5YK3{height:300px}",""]),l.locals={ProfileCard:"src-entities-Profile-ui-ProfileCard-ProfileCard-module__ProfileCard--wW9jg",avatarWrapper:"src-entities-Profile-ui-ProfileCard-ProfileCard-module__avatarWrapper--bEFNS",avatar:"src-entities-Profile-ui-ProfileCard-ProfileCard-module__avatar--ktDYi",inputAge:"src-entities-Profile-ui-ProfileCard-ProfileCard-module__inputAge--VfQJ_",loading:"src-entities-Profile-ui-ProfileCard-ProfileCard-module__loading--t07Zx",error:"src-entities-Profile-ui-ProfileCard-ProfileCard-module__error--i5YK3"},a.Z=l},5144:function(e,a,r){var i=r(8081),t=r.n(i),n=r(3645),l=r.n(n)()(t());l.push([e.id,"",""]),l.locals={},a.Z=l},7363:function(e,a,r){var i=r(3379),t=r.n(i),n=r(7795),l=r.n(n),s=r(569),o=r.n(s),d=r(3565),c=r.n(d),u=r(9216),C=r.n(u),f=r(4589),m=r.n(f),h=r(5144),x={};x.styleTagTransform=m(),x.setAttributes=c(),x.insert=o().bind(null,"head"),x.domAPI=l(),x.insertStyleElement=C(),t()(h.Z,x),a.Z=h.Z&&h.Z.locals?h.Z.locals:void 0}}]);